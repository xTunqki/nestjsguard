"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.repl = void 0;
const common_1 = require("@nestjs/common");
const _repl = require("repl");
const cli_colors_util_1 = require("@nestjs/common/utils/cli-colors.util");
const nest_factory_1 = require("../nest-factory");
const constants_1 = require("./constants");
const repl_context_1 = require("./repl-context");
const repl_logger_1 = require("./repl-logger");
const assign_to_object_util_1 = require("./assign-to-object.util");
async function repl(module) {
    const app = await nest_factory_1.NestFactory.create(module, {
        abortOnError: false,
        logger: new repl_logger_1.ReplLogger(),
    });
    await app.init();
    const replContext = new repl_context_1.ReplContext(app);
    common_1.Logger.log(constants_1.REPL_INITIALIZED_MESSAGE);
    const replServer = _repl.start({
        prompt: cli_colors_util_1.clc.green('> '),
        ignoreUndefined: true,
    });
    (0, assign_to_object_util_1.assignToObject)(replServer.context, replContext.globalScope);
    return replServer;
}
exports.repl = repl;
